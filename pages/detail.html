<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>bigin-support</title>
<link rel="stylesheet" type="text/css" href="../css/detail.css"/>
<link rel="stylesheet" type="text/css" href="../css/prism.css"/>
<link rel="stylesheet" type="text/css" href="../css/spin.css"/>
<link rel="icon" type="image/x-icon" href="../favicon.ico">
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="../js/prism.js"></script>
<script src="../js/spin.js"></script>

<meta name="viewport" content=" width=device-width, initial-scale=1 , maximum-scale=1.0, user-scalable=no,
        shrink-to-fit=no"/>

<link rel="stylesheet" href="/support-bigin.github.io/css/github-markdown.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>
<body>
<div id="spinner"></div>
<div class="detail-section">
  <div class="header">
    <div class="inner-header">
      <div class="bigin-logo pc" onclick="window.open('main.html', '_self')"></div>
      <div class="bigin-logo mobile" onclick="window.open('main.html', '_self')"></div>
      <div class="input-wrapper">
        <div class="search-icon" onclick="showHeaderInput()"></div>
        <input placeholder="도움말을 검색하세요."
               oninput="openSearchList(this.value)"
               onblur="closeSearchList()">
      </div>
      <div class="header-nav home" onclick="window.open('https://www.bigin.io', '_self')">홈으로</div>
      <div class="header-nav dashboard" onclick="window.open('https://insight.bigin.io', '_self')">대시보드로 이동</div>
    </div>

    <div class="mobile-input-form-wrapper"
    >
      <div class="search-icon"></div>
      <input placeholder="도움말을 검색하세요." oninput="openMobileSearchList(this.value)" onblur="closeMobileSearchList">
      <div class="cancel-icon"></div>
    </div>
  </div>

  <div class="content">
    <div class="content-wrapper">
      <div class="side left menu nav">

        <li class="side-title">시작하기 및 설치</li>

        <a class="side-nav installation" href="detail.html?kind=installation#installation_0">SDK 추적코드 설치하기(bigin.js)</a>
        <!--<a class="side-nav" href="detail.html?kind=installation2#installation2_0">예시 2</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation3#installation3_0">예시 3</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_2">프로젝트 생성</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_0">설치 시작하기</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_1">기본 추적 스크립트</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_2">고유 사용자 식별</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_3">커스텀 이벤트 추적</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_4">이커머스 추적 이벤트</a>-->
        <!--<a class="side-nav" href="detail.html?kind=installation#installation_5">이커머스 추적 예제</a>-->

        <li class="side-title">인사이트</li>
        <a class="side-nav insight" href="detail.html?kind=insight#insight_0">인사이트</a>
        <!--<a class="side-nav" href="detail.html?kind=insight#insight_1">인사이트 리포트란?</a>
        <a class="side-nav" href="detail.html?kind=insight#insight_2">인사이트 리포트 발행</a>
        <a class="side-nav" href="detail.html?kind=insight#insight_3">인사이트 활용하기</a>-->

        <li class="side-title">사용자</li>
        <a class="side-nav user" href="detail.html?kind=user#user_0">사용자</a>
        <!--<a class="side-nav">사용자 속성</a>
        <a class="side-nav">사용자 그룹 관리</a>
        <a class="side-nav">활성 타임라인</a>-->

        <li class="side-title">라이브</li>
        <a class="side-nav live" href="detail.html?kind=live#live_0">라이브</a>
        <!--<a class="side-nav">라이브 개요</a>
        <a class="side-nav">제한 이벤트</a>-->


        <li class="side-title">계정 및 프로젝트 관리</li>
        <a class="side-nav management" href="detail.html?kind=management#management_0">계정 및 프로젝트 관리</a>
        <!--<a class="side-nav">계정,프로젝트 계층구조</a>
        <a class="side-nav">비즈니스 설정</a>
        <a class="side-nav">계정 관리</a>
        <a class="side-nav">플랜 변경 및 결제 내역</a>
        <a class="side-nav">프로젝트 설정</a>
        <a class="side-nav">추적 정보</a>
        <a class="side-nav">데이터 수집 필터</a>-->

        <li class="side-title">시스템 요구사항</li>
        <a class="side-nav system" href="detail.html?kind=system#system_0">시스템 요구사항</a>
        <!--<a class="side-nav">지원되는 브라우저</a>-->
        <!--<a class="side-nav">사욪 가능한 언어</a>-->
        <!--<a class="side-nav">데이터 한도 및 처리가간</a>-->


        <!--<li class="side-title">FAQs</li>-->
        <!--<a class="side-nav" href="detail.html?kind=faq#faq_0">FAQs</a>-->
      </div>
      <div class="inner-content-header">
        <span></span>
        <div class="open-icon">
        </div>
      </div>
      <div class="inner-content">
        <div class="inner-inner-content" id="innerContent"></div>
        <div class="question-wrapper">
          도움이 더 필요하신가요?<br>
          <a onclick="goToContactUs()">문의</a>를 남겨주시면 이메일을 통해 자세히 답변드리겠습니다.
        </div>
      </div>
      <div class="side right menu nav">

      </div>
    </div>

  </div>
  <div class="footer">
    <!--<div class="footer-nav" onclick="window.open('usage-policy.html?kind=privacy', '_self')">개인정보처리방침</div>-->
    <!--<div class="footer-nav" onclick="window.open('usage-policy.html?kind=service', '_self')">이용약관</div>-->
    <div class="footer-nav" onclick="goToUsagePolicy('privacy')">개인정보처리방침</div>
    <div class="footer-nav" onclick="goToUsagePolicy('service')">이용약관</div>
    <div class="footer-copyright">
      Copyright ⓒ 2019 biginsight All rights reserved.
    </div>
  </div>
</div>

<script>


  /********************************
   *
   *         Variables
   *
   *********************************/

  var markdownNameList = [
    {name: '시작하기 및 설치', link: 'detail.html?kind=installation#installation_0'},
    {name: '설치 시작하기', link: 'detail.html?kind=installation#installation_0'},
    {name: '기본 추적 스크립트', link: 'detail.html?kind=installation#installation_1'},
    {name: '고유 사용자 식별', link: 'detail.html?kind=installation#installation_2'},
    {name: '커스텀 이벤트 추적', link: 'detail.html?kind=installation#installation_3'},
    {name: '이커머스 추적', link: 'detail.html?kind=installation#installation_4'},
    {name: '인사이트', link: 'detail.html?kind=insight#insight_0'},
    {name: '사용자', link: 'detail.html?kind=user#user_0'},
    {name: '라이브', link: 'detail.html?kind=live#live_0'},
    {name: '계정 및 프로젝트 관리', link: 'detail.html?kind=management#management_0'},
    {name: '시스템 요구사항', link: 'detail.html?kind=system#system_0'},
  ];

  var kind = parseQuery(window.location.search).kind;

  url = '../markdown/' + parseQuery(window.location.search).kind + '.md';

  h2List = [];
  h2Elements = [];
  h2Offsets = [];


  var activeH2;
  var mobileInnerContentHeader = '';


  if (window.XMLHttpRequest) {
    xmlhttp = new XMLHttpRequest();
  } else {
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
  }


  /********************************
   *
   *         Util Functions
   *
   *********************************/



  // href 파싱하는 함수
  function parseQuery(queryString) {
    var query = {};
    var pairs = (queryString[0] === '?' ? queryString.substr(1) : queryString).split('&');
    for (var i = 0; i < pairs.length; i++) {
      var pair = pairs[i].split('=');
      query[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');
    }
    return query;
  }


  // array 최소값
  function arrayMin(arr) {
    return arr.reduce(function (p, v) {
      return (p < v ? p : v);
    });
  }


  // array 최소값의 index;
  function indexOfMin(arr) {
    if (arr.length === 0) {
      return -1;
    }

    var min = arr[0];
    var minIndex = 0;

    for (var i = 1; i < arr.length; i++) {
      if (arr[i] < min) {
        minIndex = i;
        min = arr[i];
      }
    }

    return minIndex;
  }


  // ie 호환 new Event();
  function createNewEvent(eventName) {
    var event;
    if (typeof(Event) === 'function') {
      event = new Event(eventName);
    } else {
      event = document.createEvent('Event');
      event.initEvent(eventName, true, true);
    }
    return event;
  }

  function usePrismJs() {
    // markdownRendered trigger 발송
    // "markdownRendered" 이벤트리스너가 prism.js 에 존재함
    var event = createNewEvent('markdownRendered');
    window.dispatchEvent(event);
  }

  /********************************
   *
   *         Callbacks
   *
   *********************************/


  // 마크다운 파일 파싱 후, 출력
  parseMarkdown();


  $('.inner-content').scroll(function () {


    // web version (not mobile)
    if (window.innerWidth > 700) {

      var fromTop = $(this).scrollTop();

      h2Elements.forEach(function (i, index) {
        if ($(i).offset().top - 50 < 0) {
          h2Offsets[index] = 1000000000000;
        } else {
          h2Offsets[index] = $(i).offset().top - 50;
        }
      })


      activeH2 = h2Elements[indexOfMin(h2Offsets)];
      $('.side' + activeH2.getAttribute('id')).addClass('active');

      min = arrayMin(h2Offsets);

      h2Offsets.forEach(function (i, index) {
        if (i > 900000000000) {

          $('.side' + h2Elements[index].getAttribute('id')).removeClass('active');
        }
        if (i > min) {
          $('.side' + h2Elements[index].getAttribute('id')).removeClass('active');
        }
      })

      blockBodyScroll();

    }

    // mobile version
    else {

    }
  })

  $('.open-icon').bind('touchend, click', function () {
    if (this.classList.contains('open')) {
      $('.side.left').css('display', 'none');
      $('.inner-content').css('display', 'block')
      this.classList.remove('open');
    } else {
      this.classList.add('open');
      $('.side.left').css('display', 'block');
      $('.inner-content').css('display', 'none')
    }
  })

  $('.side.left .side-nav').bind("touchend, click", function () {
    if (window.innerWidth < 700) {
      $('.side.left').css('display', 'none');
      $('.inner-content').css('display', 'block')
      document.querySelector('.open-icon').classList.remove('open');
      window.open(this.href, '_self')
    }
  });


  $('.search-item').click(function () {
    $(".search-list").remove();
  })


  $('.cancel-icon').click(function () {
    let searchList = $('.search-list');
    // let isHover = searchList.is(":hover");

    if (searchList.length > 0 && !$('.search-list').is(":hover")) {
      $(".search-list").remove();
    }

    $('.mobile-input-form-wrapper').css('display', 'none');
    $('.inner-header').css('display', 'flex');
  })


  window.addEventListener('load', function () {
    focusLeftNav();
  })

  window.addEventListener('hashchange', function () {
    var hash = window.location.hash.replace("#", '');
    goToH2(null, hash)
  })

  /********************************
   *
   *         Helper Functions
   *
   *********************************/


  function openMobileSearchList(search) {
    let searchList = document.querySelector(".search-list");

    if (!searchList) {
      searchList = document.createElement('div');
      searchList.classList.add('search-list');
    } else {
      $(".search-item").remove();
    }


    let inputWrapper = document.querySelector('.mobile-input-form-wrapper');
    inputWrapper.appendChild(searchList);

    markdownNameList.forEach(function (element) {
      if (RegExp(search).test(element.name) && search != '') {
        let tempResult = [];
        tempResult.push(element.name);
        let searchItem = document.createElement('a');
        searchItem.classList.add('search-item');
        searchItem.innerText = element.name;
        searchItem.setAttribute('href', element.link);
        searchList.appendChild(searchItem);

        $('.search-item').click(function () {
          document.querySelector('input').value = '';
          $(".search-list").remove();
        })
      }
    })

    if (searchList.children.length == 0) {
      let searchItem = document.createElement('div');
      searchItem.classList.add('search-item');
      searchItem.classList.add('no');
      searchItem.innerText = '검색 결과가 없습니다.';
      searchList.appendChild(searchItem);
    }
  }

  function closeMobileSearchList() {
    let searchList = $('.search-list');
    // let isHover = searchList.is(":hover");

    if (searchList.length > 0 && !$('.search-list').is(":hover")) {
      $(".search-list").remove();
    }
  }

  function openSearchList(search) {

    let searchList = document.querySelector(".search-list");

    if (!searchList) {
      searchList = document.createElement('div');
      searchList.classList.add('search-list');
    } else {
      $(".search-item").remove();
    }


    let inputWrapper = document.querySelector('.input-wrapper');
    inputWrapper.appendChild(searchList);

    markdownNameList.forEach(function (element) {
      if (RegExp(search).test(element.name) && search != '') {
        let tempResult = [];
        tempResult.push(element.name);
        let searchItem = document.createElement('a');
        searchItem.classList.add('search-item');
        searchItem.innerText = element.name;
        searchItem.setAttribute('href', element.link);
        searchList.appendChild(searchItem);

        $('.search-item').click(function () {
          document.querySelector('input').value = '';
          $(".search-list").remove();
        })
      }
    })

    if (searchList.children.length == 0) {
      let searchItem = document.createElement('div');
      searchItem.classList.add('search-item');
      searchItem.classList.add('no');
      searchItem.innerText = '검색 결과가 없습니다.';
      searchList.appendChild(searchItem);
    }
  }

  function closeSearchList() {
    let searchList = $('.search-list');
    // let isHover = searchList.is(":hover");

    if (searchList.length > 0 && !$('.search-list').is(":hover")) {
      $(".search-list").remove();
    }

  }


  function showHeaderInput() {
    if (window.innerWidth < 700) {
      $('.mobile-input-form-wrapper').css('display', 'flex');
      $('.inner-header').css('display', 'none');
    }
  }

  function blockBodyScroll() {

    var innerContent = document.querySelector('.inner-content');
    var scrollHeight = innerContent.scrollHeight - innerContent.clientHeight;
    var fromTop = $(innerContent).scrollTop();
    // console.log((scrollHeight - fromTop));
    // console.log(scrollHeight - fromTop);
    if ((scrollHeight - fromTop) < 58) {
      document.querySelector(".footer").style.bottom = '-' + (scrollHeight - fromTop) + 'px';
    } else {
      document.querySelector(".footer").style.bottom = '-60px';
    }
  }


  function parseMarkdown() {

    // 스피너
    var spinner = createSpinner();

    xmlhttp.open('get', url, true);
    xmlhttp.send();
    xmlhttp.onload = function (res) {
      // var markdown = document.createElement('div');
      // markdown.innerHTML = marked(xmlhttp.responseText);
      // document.getElementById('innerContent').insertBefor(markdown);


      // 1. markdown --> html
      // 2. 파싱된 마크다운을 inner-content 태그에 삽입
      var innerContent = document.getElementById('innerContent');
      document.getElementById('innerContent').innerHTML = marked(xmlhttp.responseText);

      // if(window.innerWidth < 700){
      mobileInnerContentHeader = $('h1').text();
      $('.inner-content-header').find('span').html(mobileInnerContentHeader);
      // }


      $('.content h2').each(function (i, element) {
        var id = kind + '_' + i;
        this.setAttribute('id', id);
        h2List.push(this.innerText);
        h2Elements.push(this);


        // 우측 사이드 메뉴 생성 start
        let sideNav = document.createElement('a');
        sideNav.classList.add('side-nav');
        sideNav.classList.add('no');
        sideNav.classList.add('side' + id);
        sideNav.innerText = this.innerText;
        document.querySelector('.side.right').appendChild(sideNav);
        sideNav.addEventListener('click', function () {
          goToH2(element);
        });
        // 우측 사이드 메뉴 생성 end

      })


      // 마크다운 화면 출력 후, 스피너 종료
      spinner.stop();

      // 마크다운 내부 코드스니펫에 prism.css 적용시키는 함수.
      usePrismJs();
    }
  }


  function goToH2(element, str) {

    var innerContent = document.querySelector('.inner-content');
    var scrollHeight = innerContent.scrollHeight - innerContent.clientHeight;
    var fromTop = $(innerContent).scrollTop();

    if (!str) {
      $(innerContent).animate({
        scrollTop: (fromTop + $('#' + element.id).offset().top - 100)
      }, 500);
    }
    else {
      $(innerContent).animate({
        scrollTop: (fromTop + $('#' + str).offset().top - 100)
      }, 0);
    }
  }


  function focusLeftNav() {
    var kind = parseQuery(window.location.search).kind;

    $('.side.left .side-nav').each(function (index, element) {
      if (element.classList.contains(kind)) {
        element.classList.add('active')
      }
    })
  }


  function createSpinner() {
    var opts = {
      lines: 1, // The number of lines to draw
      length: 25, // The length of each line
      width: 25, // The line thickness
      radius: 16, // The radius of the inner circle
      scale: 1, // Scales overall size of the spinner
      corners: 1, // Corner roundness (0..1)
      color: '#ffffff', // CSS color or array of colors
      fadeColor: 'transparent', // CSS color or array of colors
      speed: 1, // Rounds per second
      rotate: 0, // The rotation offset
      animation: 'spinner-line-fade-quick', // The CSS animation name for the lines
      direction: 1, // 1: clockwise, -1: counterclockwise
      zIndex: 2e9, // The z-index (defaults to 2000000000)
      className: 'spinner', // The CSS class to assign to the spinner
      // top: '50%', // Top position relative to parent
      // left: '50%', // Left position relative to parent
      shadow: '0 0 1px transparent', // Box-shadow for the lines
      position: 'absolute', // Element positioning
      background: '#ffffff',
    };

    var target = document.getElementById('spinner');
    var spinner = new Spinner(opts).spin(target);
    target.appendChild(spinner.el);

    return spinner;
  }


  function goToUsagePolicy(which) {

    // "뒤로가기"를 위해서 현 주소 저장
    try {
      localStorage.setItem("prevLocation", window.location.href);
    } catch (e) {
      document.cookie = "prevLocation=" + window.location.href;
    }

    if (which == 'privacy') {
      window.open('usage-policy.html?kind=privacy', '_self')
    } else {
      window.open('usage-policy.html?kind=service', '_self')
    }
  }

  function goToContactUs() {

    // "뒤로가기"를 위해서 현 주소 저장
    try {
      localStorage.setItem("prevLocation", window.location.href);
    } catch (e) {
      document.cookie = "prevLocation=" + window.location.href;
    }

    window.open('contact-us.html', '_self')

  }
</script>


</body>
</html>
